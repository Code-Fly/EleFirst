select ('1900-01-01' + interval (floor(((to_days(str_to_date(`a`.`clientOperationTime`,'%Y%m%d%H%i%s')) - to_days('1900-01-01')) / 7)) * 7) day) AS `weekstart`,('1900-01-01' + interval ((floor(((to_days(str_to_date(`a`.`clientOperationTime`,'%Y%m%d%H%i%s')) - to_days('1900-01-01')) / 7)) * 7) + 6) day) AS `weekend`,`a`.`area_id` AS `area_id`,`a`.`concentrator_id` AS `concentrator_id`,`b`.`name` AS `name`,`a`.`pn` AS `pn`,max((((`a`.`totalActivePower` + 0) * `b`.`pt`) * `b`.`ct`)) AS `maxActivePower`,min((((`a`.`totalActivePower` + 0) * `b`.`pt`) * `b`.`ct`)) AS `minActivePower`,round(avg((((`a`.`totalActivePower` + 0) * `b`.`pt`) * `b`.`ct`)),2) AS `avgActivePower`,round(((avg((((`a`.`totalActivePower` + 0) * `b`.`pt`) * `b`.`ct`)) * 100) / max((((`a`.`totalActivePower` + 0) * `b`.`pt`) * `b`.`ct`))),0) AS `loadrate`,round((((max((((`a`.`totalActivePower` + 0) * `b`.`pt`) * `b`.`ct`)) - min((((`a`.`totalActivePower` + 0) * `b`.`pt`) * `b`.`ct`))) * 100) / max((((`a`.`totalActivePower` + 0) * `b`.`pt`) * `b`.`ct`))),0) AS `peakrate` from (`t_003_type_one_data_fn25` `a` join `t_202_pn_info` `b`) where ((`a`.`area_id` = `b`.`area_id`) and (`a`.`concentrator_id` = `b`.`concentrator_id`) and (`a`.`pn` = `b`.`pn`)) group by floor(((to_days(str_to_date(`a`.`clientOperationTime`,'%Y%m%d%H%i%s')) - to_days('1900-01-01')) / 7)),`a`.`area_id`,`a`.`concentrator_id`,`a`.`pn`